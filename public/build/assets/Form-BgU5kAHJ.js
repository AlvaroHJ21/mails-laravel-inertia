import{r,j as e,y as u}from"./app-4tbyBMrE.js";import{B as c}from"./Button-BLJe90_D.js";import p from"./Editor-UScxTOMs.js";function h(i){const[n,l]=r.useState(i);function a(t){l(o=>({...o,...t}))}return{values:n,handleChange:a}}function x(i){const{text:n}=i,[l,a]=r.useState("");function t(o){var m;const s=(m=o.target.files)==null?void 0:m[0];s&&a(s.name)}return e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"font-bold btn btn-secondary",children:[n??"Subir archivo",e.jsx("input",{id:"file",type:"file",className:"input",name:"perfilamiento",hidden:!0,onChange:t})]}),e.jsx("div",{className:"absolute left-0 right-0 w-fit",children:e.jsx("label",{className:"text-xs italic text-nowrap",children:l})})]})}async function j(i){const n=`
    <!DOCTYPE html>
    <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Document</title>
        </head>
        <body>
            <div class="ck-content">
            ${i}
            </div>
        </body>
    </html>
    `,l=await fetch("/api/html/inline",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({html:n})});if(!l.ok)return{ok:l.ok,html:""};const a=await l.json();return{ok:l.ok,html:a.html}}function N(i){const{campania:n,onClose:l}=i,{values:a,handleChange:t}=h({name:"",email_send:"",send_date:"",send_medium:0,link:"",subject:"",content:""});r.useEffect(()=>(n&&t({name:n.nombre,email_send:n.correo_envio,send_date:n.fecha_envio,send_medium:n.medio_envio,link:n.link,subject:n.asunto,content:n.contenido}),()=>{}),[n]);async function o(){const s=await j(a.content);s.ok?(navigator.clipboard.writeText(s.html),window.toast.success("HTML generado y copiado al portapapeles",{position:"bottom-center"})):window.toast.error("Error al generar el HTML",{position:"bottom-center"})}async function d(){n?u.put(route("campanias.update",{campania:n.id}),{nombre:a.name,correo_envio:a.email_send,fecha_envio:a.send_date,medio_envio:a.send_medium,link:a.link,asunto:a.subject,contenido:a.content},{onError:s=>{console.log(s),window.toast.error("Error al actualizar la campaña")},onSuccess:()=>{window.toast.success("Campaña actualizada"),l&&l()}}):u.post(route("campanias.store"),{nombre:a.name,correo_envio:a.email_send,fecha_envio:a.send_date,medio_envio:a.send_medium,link:a.link,asunto:a.subject,contenido:a.content},{onError:s=>{console.log(s),window.toast.error("Error al guardar la campaña")},onSuccess:()=>{window.toast.success("Campaña creada"),l&&l()}})}return e.jsx("div",{className:"h-screen p-12",children:e.jsxs("div",{className:"flex h-full gap-8",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-2 mb-4 gap-y-4 gap-x-8",children:[e.jsxs("label",{className:"field",children:[e.jsx("span",{className:"text-lg label",children:"Nombre de la campaña"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-icon",children:e.jsx("i",{className:"fa fa-user"})}),e.jsx("input",{type:"text",className:"input",placeholder:"Nombre",name:"name",value:a.name,onChange:s=>t({name:s.target.value})})]})]}),e.jsxs("label",{className:"field",children:[e.jsx("span",{className:"text-lg label",children:"Correo de envío"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-icon",children:e.jsx("i",{className:"fa fa-envelope"})}),e.jsxs("select",{className:"input",name:"email_send",value:a.email_send,onChange:s=>t({email_send:s.target.value}),children:[e.jsx("option",{value:"",children:"Seleccionar correo"}),e.jsx("option",{value:"correo1@email.com",children:"correo1@email.com"}),e.jsx("option",{value:"correo1@email.com",children:"correo2@email.com"})]})]})]}),e.jsxs("label",{className:"field",children:[e.jsx("span",{className:"text-lg label",children:"Fecha y hora del envío"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-icon",children:e.jsx("i",{className:"fa fa-calendar"})}),e.jsx("input",{type:"datetime-local",className:"input",placeholder:"Nombre",name:"send_date",value:a.send_date,onChange:s=>t({send_date:s.target.value})})]})]}),e.jsxs("label",{className:"field",children:[e.jsx("span",{className:"text-lg label",children:"Listado de datos"}),e.jsx(x,{text:"Cargar archivo..."})]}),e.jsxs("label",{className:"field",children:[e.jsx("span",{className:"text-lg label",children:"Medio de envío"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-icon",children:e.jsx("i",{className:"fa fa-paper-plane"})}),e.jsxs("select",{className:"input",name:"send_medium",value:a.send_medium,onChange:s=>t({send_medium:+s.target.value}),children:[e.jsx("option",{value:"0",children:"Correo electrónico"}),e.jsx("option",{value:"1",children:"Whatsapp"})]})]})]}),e.jsxs("label",{className:"field",children:[e.jsx("span",{className:"text-lg label",children:"Link"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-icon",children:e.jsx("i",{className:"fa fa-link"})}),e.jsx("input",{type:"text",className:"input",placeholder:"https://...",name:"link",value:a.link,onChange:s=>t({link:s.target.value})})]})]}),e.jsxs("label",{className:"field",children:[e.jsx("span",{className:"text-lg label",children:"Subject"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-icon",children:e.jsx("i",{className:"fa fa-paperclip"})}),e.jsx("input",{type:"text",className:"input",placeholder:"Escribe el asunto...",name:"subject",value:a.subject,onChange:s=>t({subject:s.target.value})})]})]}),e.jsx("div",{className:"grid col-span-2 place-content-center",children:e.jsx(p,{value:a.content,onChange:s=>t({content:s})})})]}),e.jsx(c,{onClick:d,children:"Guardar campaña"})]}),e.jsxs("div",{className:"relative flex-1 overflow-y-auto rounded-lg shadow-lg",children:[e.jsx("div",{className:"h-full p-4 bg-gray-200",children:e.jsxs("div",{className:"h-full p-4 overflow-y-auto bg-white rounded-lg",children:[e.jsx("h2",{className:"mb-2 text-3xl font-bold",children:a.subject}),e.jsx("div",{className:"ck-content",dangerouslySetInnerHTML:{__html:a.content}})]})}),e.jsxs("div",{className:"absolute left-0 right-0 flex gap-2 m-auto w-fit bottom-8",children:[e.jsx(c,{children:"Exportar a HTML"}),e.jsx(c,{onClick:o,className:"bottom-8",children:"Genererar / Copiar HTML"})]})]})]})})}export{N as default};
