import{j as a,r as i,a as B}from"./app-BAbNKuvN.js";import{A as V}from"./AuthenticatedLayout-Ds1yjU1C.js";import{A as G}from"./Alert-ClA_9KX2.js";import f from"./FilterSelect-BnIs6igy.js";import J from"./MainResultCard-D0PA-HCH.js";import P from"./OpenRateCard-H3NADohA.js";import k from"./SuccessRateCard-rvAQld6G.js";import{T as E}from"./Tooltip-HOZJquHL.js";import{e as H}from"./excel-BG5q7fmZ.js";const m=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],W=[{id:1,nombre:"Campaña de prueba 1",n_registros:123,n_validados:78,n_abiertos:67,fecha_envio:"2024-01-01",medio_envio:0},{id:2,nombre:"Campaña de prueba 2",n_registros:59,n_validados:37,n_abiertos:22,fecha_envio:"2024-02-12",medio_envio:0},{id:3,nombre:"Campaña de prueba 3",n_registros:187,n_validados:120,n_abiertos:102,fecha_envio:"2024-03-25",medio_envio:0},{id:4,nombre:"Campaña de prueba 4",n_registros:82,n_validados:57,n_abiertos:35,fecha_envio:"2024-04-30",medio_envio:0},{id:5,nombre:"Campaña de prueba 5",n_registros:175,n_validados:98,n_abiertos:80,fecha_envio:"2024-05-17",medio_envio:0},{id:6,nombre:"Campaña de prueba 6",n_registros:33,n_validados:20,n_abiertos:14,fecha_envio:"2024-06-04",medio_envio:0},{id:7,nombre:"Campaña de prueba 7",n_registros:194,n_validados:140,n_abiertos:123,fecha_envio:"2024-07-20",medio_envio:0},{id:8,nombre:"Campaña de prueba 8",n_registros:91,n_validados:72,n_abiertos:65,fecha_envio:"2024-08-14",medio_envio:0},{id:9,nombre:"Campaña de prueba 9",n_registros:118,n_validados:76,n_abiertos:59,fecha_envio:"2024-09-09",medio_envio:0},{id:10,nombre:"Campaña de prueba 10",n_registros:45,n_validados:27,n_abiertos:15,fecha_envio:"2024-10-28",medio_envio:0},{id:11,nombre:"Campaña de prueba 11",n_registros:63,n_validados:44,n_abiertos:29,fecha_envio:"2024-11-05",medio_envio:0},{id:12,nombre:"Campaña de prueba 12",n_registros:99,n_validados:70,n_abiertos:58,fecha_envio:"2024-12-19",medio_envio:0},{id:13,nombre:"Campaña de prueba 13",n_registros:153,n_validados:111,n_abiertos:95,fecha_envio:"2024-01-23",medio_envio:0},{id:14,nombre:"Campaña de prueba 14",n_registros:24,n_validados:17,n_abiertos:9,fecha_envio:"2024-02-10",medio_envio:0},{id:15,nombre:"Campaña de prueba 15",n_registros:87,n_validados:53,n_abiertos:43,fecha_envio:"2024-03-02",medio_envio:0},{id:16,nombre:"Campaña de prueba 16",n_registros:134,n_validados:82,n_abiertos:75,fecha_envio:"2024-04-14",medio_envio:0},{id:17,nombre:"Campaña de prueba 17",n_registros:37,n_validados:19,n_abiertos:8,fecha_envio:"2024-05-30",medio_envio:0},{id:18,nombre:"Campaña de prueba 18",n_registros:171,n_validados:102,n_abiertos:84,fecha_envio:"2024-06-22",medio_envio:0},{id:19,nombre:"Campaña de prueba 19",n_registros:76,n_validados:52,n_abiertos:40,fecha_envio:"2024-07-07",medio_envio:0},{id:20,nombre:"Campaña de prueba 20",n_registros:109,n_validados:81,n_abiertos:64,fecha_envio:"2024-08-31",medio_envio:0},{id:21,nombre:"Campaña de prueba 21",n_registros:88,n_validados:54,n_abiertos:39,fecha_envio:"2024-09-22",medio_envio:0},{id:22,nombre:"Campaña de prueba 22",n_registros:175,n_validados:113,n_abiertos:97,fecha_envio:"2024-10-09",medio_envio:0},{id:23,nombre:"Campaña de prueba 23",n_registros:42,n_validados:26,n_abiertos:14,fecha_envio:"2024-11-15",medio_envio:0},{id:24,nombre:"Campaña de prueba 24",n_registros:93,n_validados:65,n_abiertos:55,fecha_envio:"2024-12-01",medio_envio:0},{id:25,nombre:"Campaña de prueba 25",n_registros:147,n_validados:85,n_abiertos:77,fecha_envio:"2024-01-28",medio_envio:0},{id:26,nombre:"Campaña de prueba 26",n_registros:29,n_validados:16,n_abiertos:9,fecha_envio:"2024-02-11",medio_envio:0},{id:27,nombre:"Campaña de prueba 27",n_registros:68,n_validados:45,n_abiertos:35,fecha_envio:"2024-03-19",medio_envio:0},{id:28,nombre:"Campaña de prueba 28",n_registros:119,n_validados:72,n_abiertos:60,fecha_envio:"2024-04-05",medio_envio:0},{id:29,nombre:"Campaña de prueba 29",n_registros:53,n_validados:35,n_abiertos:21,fecha_envio:"2024-05-20",medio_envio:0},{id:30,nombre:"Campaña de prueba 30",n_registros:180,n_validados:120,n_abiertos:105,fecha_envio:"2024-06-13",medio_envio:0},{id:31,nombre:"Campaña de prueba 31",n_registros:67,n_validados:43,n_abiertos:35,fecha_envio:"2024-07-25",medio_envio:0},{id:32,nombre:"Campaña de prueba 32",n_registros:128,n_validados:89,n_abiertos:70,fecha_envio:"2024-08-18",medio_envio:0},{id:33,nombre:"Campaña de prueba 33",n_registros:41,n_validados:23,n_abiertos:17,fecha_envio:"2024-09-04",medio_envio:0},{id:34,nombre:"Campaña de prueba 34",n_registros:97,n_validados:66,n_abiertos:49,fecha_envio:"2024-10-27",medio_envio:0},{id:35,nombre:"Campaña de prueba 35",n_registros:139,n_validados:92,n_abiertos:85,fecha_envio:"2024-11-10",medio_envio:0},{id:36,nombre:"Campaña de prueba 36",n_registros:75,n_validados:47,n_abiertos:38,fecha_envio:"2024-12-29",medio_envio:0},{id:37,nombre:"Campaña de prueba 37",n_registros:150,n_validados:105,n_abiertos:87,fecha_envio:"2024-01-14",medio_envio:0},{id:38,nombre:"Campaña de prueba 38",n_registros:21,n_validados:14,n_abiertos:8,fecha_envio:"2024-02-06",medio_envio:0},{id:39,nombre:"Campaña de prueba 39",n_registros:63,n_validados:41,n_abiertos:31,fecha_envio:"2024-03-24",medio_envio:0},{id:40,nombre:"Campaña de prueba 40",n_registros:104,n_validados:68,n_abiertos:51,fecha_envio:"2024-04-17",medio_envio:0}];function O(c,p){return p===0?0:parseFloat((c/p*100).toFixed(2))}const K="/build/assets/bouncing-squares-DPrARwh9.svg";function Q({width:c=60}){return a.jsx("img",{src:K,alt:"",width:c,className:"m-auto"})}function re(c){const{auth:p,flash:h,campanias:A}=c,[d,T]=i.useState(2024),[s,N]=i.useState("Todos"),[r,u]=i.useState(0),[g,D]=i.useState(!1),[S,R]=i.useState(!0),b=i.useRef(null),x=i.useRef(null),C=i.useRef(null),[M,y]=i.useState(A),t=g?W:M;i.useEffect(()=>(h.data&&u(h.data.id),()=>{}),[h.data]),i.useEffect(()=>{async function e(){R(!0);const n=await(await fetch(route("campanias.update_and_get"))).json();y(n),R(!1)}return e(),()=>{}},[]);const w=i.useMemo(()=>{let e=[...t];return e=e.filter(o=>new Date(o.fecha_envio).getUTCFullYear()===d),e=e.filter(o=>s==="Todos"||m[new Date(o.fecha_envio).getUTCMonth()]===s),r!==0&&(e=e.filter(o=>o.id===r)),e},[d,r,s,t]);i.useEffect(()=>{const e=t.find(o=>o.id===r);if(e){const o=new Date(e.fecha_envio).getUTCFullYear();o!==d&&T(o);const n=m[new Date(e.fecha_envio).getUTCMonth()];n!==s&&N(n)}return()=>{}},[r]),i.useEffect(()=>{const e=t.find(o=>o.id===r);return e&&(m[new Date(e.fecha_envio).getUTCMonth()]!==s&&u(0),new Date(e.fecha_envio).getUTCFullYear()!==d&&u(0)),()=>{}},[d,s]);const j=i.useMemo(()=>m.map(o=>{const n=w.filter(l=>new Date(l.fecha_envio).getUTCMonth()===m.indexOf(o)),v=n.reduce((l,_)=>l+_.n_registros,0),I=n.reduce((l,_)=>l+_.n_validados,0),q=n.reduce((l,_)=>l+_.n_abiertos,0);return{month:o,year:2023,nTotalRecords:v,nValidRecords:I,nOpenedRecords:q,nCampanias:n.length}}),[w,t]);i.useEffect(()=>{var o;function e(){var v;const n=((v=b.current)==null?void 0:v.scrollLeft)??0;x.current&&(x.current.scrollLeft=n),C.current&&(C.current.scrollLeft=n)}return(o=b.current)==null||o.addEventListener("scroll",e),()=>{var n;(n=b.current)==null||n.removeEventListener("scroll",e)}},[S]);const L=[2023,2024,2025].map(e=>({text:e.toString(),value:e})),F=[{text:"Todos",value:"Todos"},...m.map(e=>({text:e,value:e}))],U=[{text:"Todas",value:0},...t.map(e=>({text:e.nombre,value:e.id}))],z=["Email","SMS","WhatsApp"].map(e=>({text:e,value:e}));function Y(){let e=[...t];if(r!=0){const o=t.find(n=>n.id===r);o&&(e=[o])}else e=e.filter(o=>new Date(o.fecha_envio).getUTCFullYear()===d),e=e.filter(o=>s==="Todos"||m[new Date(o.fecha_envio).getUTCMonth()]===s);return e.map(o=>o.id)}return a.jsxs(V,{user:p.user,children:[a.jsx(B,{title:"Resultados"}),a.jsx("h1",{className:"title",children:"Resultados de Campañas"}),a.jsx(G,{text:"En nuestro módulo de resultados de campañas encontrarás los principales indicadores de las campañas realizadas."}),a.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[a.jsx(f,{label:"Año",options:L,value:d,onChange:e=>T(Number(e))}),a.jsx(f,{label:"Mes",value:s,onChange:e=>N(e.toString()),options:F}),a.jsx(f,{label:"Campaña",value:r,options:U,onChange:e=>u(Number(e))}),a.jsx(f,{label:"Medio",value:"Email",options:z})]}),a.jsxs("div",{className:"bg-[#e3f3fb] p-8 rounded-md",children:[a.jsx("h2",{className:"mb-4 font-bold text-azul-marino",children:"Campañas generadas"}),a.jsx("div",{ref:b,className:"w-full pb-2 mb-8 overflow-x-auto",children:a.jsx("div",{className:"flex gap-2",children:j.map(e=>a.jsx(J,{result:e},e.month))})}),a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx("h2",{className:"font-bold text-azul-marino",children:"Tasa de entrega"}),a.jsx(E,{text:"Se calcula con",subtext:"TOTAL ENTREGADOS / TOTAL",children:a.jsx("div",{className:"grid w-4 h-4 rounded-full bg-azul-marino text-amarillo place-content-center",children:a.jsx("i",{className:"text-xs fa fa-question"})})})]}),a.jsx("div",{ref:x,className:"w-full pb-2 mb-8 overflow-x-auto",children:a.jsx("div",{className:"flex gap-2",children:j.map(e=>a.jsx(k,{value:O(e.nValidRecords,e.nTotalRecords)},e.month))})}),a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx("h2",{className:"font-bold text-azul-marino",children:"Tasa de apertura"}),a.jsx(E,{text:"Se calcula con",subtext:"TOTAL ABIERTOS / TOTAL ENTREGADOS",children:a.jsx("div",{className:"grid w-4 h-4 rounded-full bg-azul-marino text-amarillo place-content-center",children:a.jsx("i",{className:"text-xs fa fa-question"})})})]}),a.jsx("div",{ref:C,className:"w-full pb-2 mb-8 overflow-x-auto",children:a.jsx("div",{className:"flex gap-2",children:j.map(e=>a.jsx(P,{value:O(e.nOpenedRecords,e.nValidRecords)},e.month))})}),a.jsxs("a",{href:route("resultados.download",{campanias:Y()}),className:"btn btn-sm btn-primary",children:["Descargar reporte"," ",a.jsx("img",{src:H,alt:"icono de excel",width:24})]})]}),S&&a.jsxs("div",{className:"fixed flex items-center gap-2 px-3 py-1 bg-white rounded-md shadow-md right-4 top-16",children:[a.jsx("span",{className:"text-sm font-normal",children:"Sincronizando reportes"}),a.jsx(Q,{width:20})]}),a.jsx("button",{onClick:()=>D(!g),className:"fixed btn btn-secondary btn-sm bottom-4 right-4",children:g?a.jsx("span",{children:"Datos reales"}):a.jsxs("span",{children:[a.jsx("i",{className:"mr-1 fa fa-vial"}),"Datos de prueba"]})})]})}export{re as default};
