import{r as v}from"./app-goKU949F.js";const O=[{id:1,text:"15-24",value:"JOVEN"},{id:2,text:"25-44",value:"ADULTO"},{id:3,text:"45-59",value:"ADULTO MAYOR"},{id:4,text:"+60",value:"TERCERA EDAD"}],D=[{id:1,text:"Hombres",value:"M"},{id:2,text:"Mujeres",value:"F"}],I=[{id:1,text:"Solteros",value:"SOLTERO"},{id:2,text:"Casados",value:"CASADO"},{id:3,text:"Divorciados",value:"DIVORCIADO"},{id:4,text:"Viudos",value:"VIUDO"}],L=[{id:1,text:"Generación Alpha",value:"GENERACIÓN ALPHA"},{id:2,text:"Generación Z",value:"GENERACIÓN Z"},{id:3,text:"Millennials",value:"MILLENNIALS"},{id:4,text:"Generación X",value:"GENERACIÓN X"},{id:5,text:"Boomers",value:"BOOMERS"},{id:6,text:"Silenciosa",value:"GENERACIÓN SILENCIOSA"}];function R(u,o){if(u===null||o===null||u==null||o===void 0||u===""||o==="")return!1;const d=u.toString().replace("Ã‘","Ñ").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),c=o.toString().replace("Ã‘","Ñ").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return d===c}function E(u,o){let d=[...u.personas];return o.forEach(c=>{c.filters.length>0&&(d=d.filter(x=>c.filters.some(p=>R(x[c.attr],p.value))))}),d.length}function G(u){return u.filter((d,c,x)=>x.indexOf(d)===c&&d!==null)}function V(u){const{segmento:o,departamentos:d,provincias:c,distritos:x}=u,[p,m]=v.useState([]),[l,f]=v.useState([]),F=v.useMemo(()=>{let t=[...l],s=[];for(let r=0;r<t.length;r++)s.push(E(o,t.slice(0,r+1)));return s},[l]),A=v.useMemo(()=>E(o,l),[l]);v.useEffect(()=>(m([{attr:"edad_grupo",filters:O,text:"Edad"},{attr:"estado_civil",filters:I,text:"Estado Civil"},{attr:"sexo",filters:D,text:"Género"},{attr:"generacion",filters:L,text:"Generación"},{attr:"departamento",filters:d.map(t=>({id:t.id,text:t.name,value:t.name})),text:"Departamento"},{attr:"provincia",filters:[],text:"Provincia",table:!0},{attr:"distrito",filters:[],text:"Distrito",table:!0},{attr:"var1",filters:G(o.personas.map(t=>t.var1)).map(t=>({id:t,text:t,value:t})),text:"Variable 1",table:!0},{attr:"var2",filters:G(o.personas.map(t=>t.var2)).map(t=>({id:t,text:t,value:t})),text:"Variable 2",table:!0},{attr:"var3",filters:G(o.personas.map(t=>t.var3)).map(t=>({id:t,text:t,value:t})),text:"Variable 3",table:!0}]),()=>{}),[]),v.useEffect(()=>(f(o.filtros),()=>{}),[o]),v.useEffect(()=>{const t=l.find(s=>s.attr==="departamento");if(t){const s=t.filters.map(e=>e.id),r=c.filter(e=>s.includes(e.department_id)).map(e=>({id:e.id,text:e.name,value:e.name}));p.find(e=>e.attr==="provincia")&&m(e=>e.map(n=>n.attr==="provincia"?{...n,filters:r}:n));const i=l.find(e=>e.attr==="provincia");f(i?e=>e.map(n=>n.attr==="provincia"?{...n,filters:r}:n):e=>[...e,{attr:"provincia",text:"Provincia",filters:r}])}else{const s=p.find(a=>a.attr==="provincia"),r=p.find(a=>a.attr==="distrito");s&&m(a=>a.map(i=>i.attr==="provincia"?{...i,filters:[]}:i)),r&&m(a=>a.map(i=>i.attr==="distrito"?{...i,filters:[]}:i))}return()=>{}},[l.find(t=>t.attr==="departamento")]),v.useEffect(()=>{const t=l.find(s=>s.attr==="provincia");if(t){const s=t.filters.map(i=>i.id),r=x.filter(i=>s.includes(i.province_id)).map(i=>({id:i.id,text:i.name,value:i.name}));p.find(i=>i.attr==="distrito")&&m(i=>i.map(e=>e.attr==="distrito"?{...e,filters:r}:e))}else p.find(r=>r.attr==="distrito")&&m(r=>r.map(a=>a.attr==="distrito"?{...a,filters:[]}:a));return()=>{}},[l.find(t=>t.attr==="provincia")]);function C(){f([])}function S(t,s){return l.some(r=>r.attr===t.attr&&r.filters.some(a=>a.id===s.id))}function N(t,s){const r=l.find(a=>a.attr===t.attr);if(r){const a=r.filters.find(e=>e.id===s.id),i={...r};a?i.filters=i.filters.filter(e=>e.id!==s.id):i.filters=[...i.filters,{...s}],i.filters.length===0?(f(e=>e.filter(n=>n.attr!==t.attr)),t.attr==="departamento"&&(f(e=>e.filter(n=>n.attr!=="provincia")),f(e=>e.filter(n=>n.attr!=="distrito"))),t.attr==="provincia"&&f(e=>e.filter(n=>n.attr!=="distrito"))):f(e=>e.map(n=>n.attr===t.attr?i:n))}else f(a=>[...a,{...t,filters:[s]}])}return{allFilterGroups:p,activeFilterGroups:l,partialCounts:F,totalCount:A,resetFilters:C,isFilterActive:S,toogleFilter:N}}export{V as default};
