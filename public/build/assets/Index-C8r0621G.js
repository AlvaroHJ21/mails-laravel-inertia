import{j as o,M as z,r as s,a as Y}from"./app-BkUDfJSJ.js";import{A as I}from"./AuthenticatedLayout-i4O8A1KD.js";import{A as V}from"./Alert-DMFqvoet.js";import h from"./FilterSelect-tMmmjLoL.js";import J from"./MainResultCard-C6DYNHH7.js";import W from"./OpenRateCard-D2uUA7ZP.js";import k from"./SuccessRateCard-COpjjroM.js";import{L as H}from"./Loader-BjQMitxb.js";const c=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],P=[{id:1,n_registros:123,n_validados:78,n_abiertos:67,fecha_envio:"2023-01-01",medio_envio:0},{id:2,n_registros:59,n_validados:37,n_abiertos:22,fecha_envio:"2023-02-12",medio_envio:0},{id:3,n_registros:187,n_validados:120,n_abiertos:102,fecha_envio:"2023-03-25",medio_envio:0},{id:4,n_registros:82,n_validados:57,n_abiertos:35,fecha_envio:"2023-04-30",medio_envio:0},{id:5,n_registros:175,n_validados:98,n_abiertos:80,fecha_envio:"2023-05-17",medio_envio:0},{id:6,n_registros:33,n_validados:20,n_abiertos:14,fecha_envio:"2023-06-04",medio_envio:0},{id:7,n_registros:194,n_validados:140,n_abiertos:123,fecha_envio:"2023-07-20",medio_envio:0},{id:8,n_registros:91,n_validados:72,n_abiertos:65,fecha_envio:"2023-08-14",medio_envio:0},{id:9,n_registros:118,n_validados:76,n_abiertos:59,fecha_envio:"2023-09-09",medio_envio:0},{id:10,n_registros:45,n_validados:27,n_abiertos:15,fecha_envio:"2023-10-28",medio_envio:0},{id:11,n_registros:63,n_validados:44,n_abiertos:29,fecha_envio:"2023-11-05",medio_envio:0},{id:12,n_registros:99,n_validados:70,n_abiertos:58,fecha_envio:"2023-12-19",medio_envio:0},{id:13,n_registros:153,n_validados:111,n_abiertos:95,fecha_envio:"2023-01-23",medio_envio:0},{id:14,n_registros:24,n_validados:17,n_abiertos:9,fecha_envio:"2023-02-10",medio_envio:0},{id:15,n_registros:87,n_validados:53,n_abiertos:43,fecha_envio:"2023-03-02",medio_envio:0},{id:16,n_registros:134,n_validados:82,n_abiertos:75,fecha_envio:"2023-04-14",medio_envio:0},{id:17,n_registros:37,n_validados:19,n_abiertos:8,fecha_envio:"2023-05-30",medio_envio:0},{id:18,n_registros:171,n_validados:102,n_abiertos:84,fecha_envio:"2023-06-22",medio_envio:0},{id:19,n_registros:76,n_validados:52,n_abiertos:40,fecha_envio:"2023-07-07",medio_envio:0},{id:20,n_registros:109,n_validados:81,n_abiertos:64,fecha_envio:"2023-08-31",medio_envio:0},{id:21,n_registros:88,n_validados:54,n_abiertos:39,fecha_envio:"2023-09-22",medio_envio:0},{id:22,n_registros:175,n_validados:113,n_abiertos:97,fecha_envio:"2023-10-09",medio_envio:0},{id:23,n_registros:42,n_validados:26,n_abiertos:14,fecha_envio:"2023-11-15",medio_envio:0},{id:24,n_registros:93,n_validados:65,n_abiertos:55,fecha_envio:"2023-12-01",medio_envio:0},{id:25,n_registros:147,n_validados:85,n_abiertos:77,fecha_envio:"2023-01-28",medio_envio:0},{id:26,n_registros:29,n_validados:16,n_abiertos:9,fecha_envio:"2023-02-11",medio_envio:0},{id:27,n_registros:68,n_validados:45,n_abiertos:35,fecha_envio:"2023-03-19",medio_envio:0},{id:28,n_registros:119,n_validados:72,n_abiertos:60,fecha_envio:"2023-04-05",medio_envio:0},{id:29,n_registros:53,n_validados:35,n_abiertos:21,fecha_envio:"2023-05-20",medio_envio:0},{id:30,n_registros:180,n_validados:120,n_abiertos:105,fecha_envio:"2023-06-13",medio_envio:0},{id:31,n_registros:67,n_validados:43,n_abiertos:35,fecha_envio:"2023-07-25",medio_envio:0},{id:32,n_registros:128,n_validados:89,n_abiertos:70,fecha_envio:"2023-08-18",medio_envio:0},{id:33,n_registros:41,n_validados:23,n_abiertos:17,fecha_envio:"2023-09-04",medio_envio:0},{id:34,n_registros:97,n_validados:66,n_abiertos:49,fecha_envio:"2023-10-27",medio_envio:0},{id:35,n_registros:139,n_validados:92,n_abiertos:85,fecha_envio:"2023-11-10",medio_envio:0},{id:36,n_registros:75,n_validados:47,n_abiertos:38,fecha_envio:"2023-12-29",medio_envio:0},{id:37,n_registros:150,n_validados:105,n_abiertos:87,fecha_envio:"2023-01-14",medio_envio:0},{id:38,n_registros:21,n_validados:14,n_abiertos:8,fecha_envio:"2023-02-06",medio_envio:0},{id:39,n_registros:63,n_validados:41,n_abiertos:31,fecha_envio:"2023-03-24",medio_envio:0},{id:40,n_registros:104,n_validados:68,n_abiertos:51,fecha_envio:"2023-04-17",medio_envio:0}];function S(v,d){return d===0?0:parseFloat((v/d*100).toFixed(2))}function q(v){const{text:d}=v;return o.jsx(z,{show:!0,onClose:()=>{},maxWidth:"xs",closeable:!1,children:o.jsxs("div",{className:"p-8 text-center",children:[d,o.jsx("div",{className:"m-auto w-fit",children:o.jsx(H,{})})]})})}function oe(v){const{auth:d}=v,[_,C]=s.useState(2023),[n,R]=s.useState("Todos"),[t,p]=s.useState(0),[b,T]=s.useState(!0),[w,N]=s.useState(!0),f=s.useRef(null),g=s.useRef(null),x=s.useRef(null),[E,L]=s.useState([]),l=b?P:E;s.useEffect(()=>{async function e(){N(!0);const a=await(await fetch(route("campanias.update_and_get"))).json();L(a),N(!1)}return e(),()=>{}},[]);const M=s.useMemo(()=>{let e=[...l];return e=e.filter(i=>new Date(i.fecha_envio).getUTCFullYear()===_),e=e.filter(i=>n==="Todos"||c[new Date(i.fecha_envio).getUTCMonth()]===n),t!==0&&(e=e.filter(i=>i.id===t)),e},[_,t,n,l]);s.useEffect(()=>{const e=l.find(i=>i.id===t);if(e){const i=new Date(e.fecha_envio).getUTCFullYear();i!==_&&C(i);const a=c[new Date(e.fecha_envio).getUTCMonth()];a!==n&&R(a)}return()=>{}},[t]),s.useEffect(()=>{const e=l.find(i=>i.id===t);return e&&(c[new Date(e.fecha_envio).getUTCMonth()]!==n&&p(0),new Date(e.fecha_envio).getUTCFullYear()!==_&&p(0)),()=>{}},[_,n]);const j=s.useMemo(()=>c.map(i=>{const a=M.filter(r=>new Date(r.fecha_envio).getUTCMonth()===c.indexOf(i)),u=a.reduce((r,m)=>r+m.n_registros,0),F=a.reduce((r,m)=>r+m.n_validados,0),U=a.reduce((r,m)=>r+m.n_abiertos,0);return{month:i,year:2023,nTotalRecords:u,nValidRecords:F,nOpenedRecords:U,nCampanias:a.length}}),[M,l]);s.useEffect(()=>{var i;function e(){var u;const a=((u=f.current)==null?void 0:u.scrollLeft)??0;g.current&&(g.current.scrollLeft=a),x.current&&(x.current.scrollLeft=a)}return(i=f.current)==null||i.addEventListener("scroll",e),()=>{var a;(a=f.current)==null||a.removeEventListener("scroll",e)}},[]);const D=[2023,2024,2025].map(e=>({text:e.toString(),value:e})),O=[{text:"Todos",value:"Todos"},...c.map(e=>({text:e,value:e}))],A=[{text:"Todas",value:0},...l.map(e=>({text:"Campaña "+e.id,value:e.id}))],y=["Email","SMS","WhatsApp"].map(e=>({text:e,value:e}));return o.jsxs(I,{user:d.user,children:[o.jsx(Y,{title:"Resultados"}),o.jsx("h1",{className:"title",children:"Resultados de Campañas"}),o.jsx(V,{text:"En nuestro módulo de resultados de campañas encontrarás los principales indicadores de las campañas realizadas."}),o.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[o.jsx(h,{label:"Año",options:D,value:_,onChange:e=>C(Number(e))}),o.jsx(h,{label:"Mes",value:n,onChange:e=>R(e.toString()),options:O}),o.jsx(h,{label:"Campaña",value:t,options:A,onChange:e=>p(Number(e))}),o.jsx(h,{label:"Medio",value:"Email",options:y})]}),w?o.jsx(q,{text:"Actualizando reporte de campañas"}):o.jsxs("div",{className:"bg-[#e3f3fb] p-8 rounded-md",children:[o.jsx("h2",{className:"mb-4 font-bold text-azul-marino",children:"Campañas generadas"}),o.jsx("div",{ref:f,className:"w-full pb-2 mb-8 overflow-x-auto",children:o.jsx("div",{className:"flex gap-2",children:j.map(e=>o.jsx(J,{result:e},e.month))})}),o.jsx("h2",{className:"mb-4 font-bold text-azul-marino",children:"Tasa de éxito de envío"}),o.jsx("div",{ref:g,className:"w-full pb-2 mb-8 overflow-x-auto",children:o.jsx("div",{className:"flex gap-2",children:j.map(e=>o.jsx(k,{value:S(e.nValidRecords,e.nTotalRecords)},e.month))})}),o.jsx("h2",{className:"mb-4 font-bold text-azul-marino",children:"Tasa de apertura"}),o.jsx("div",{ref:x,className:"w-full pb-2 mb-8 overflow-x-auto",children:o.jsx("div",{className:"flex gap-2",children:j.map(e=>o.jsx(W,{value:S(e.nOpenedRecords,e.nValidRecords)},e.month))})})]}),o.jsx("button",{onClick:()=>T(!b),className:"fixed btn btn-secondary btn-sm bottom-4 right-4",children:b?o.jsxs("span",{children:[o.jsx("i",{className:"mr-1 fa fa-vial"}),"Datos de prueba"]}):o.jsx("span",{children:"Datos reales"})})]})}export{oe as default};
