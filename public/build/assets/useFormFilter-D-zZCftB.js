import{r as f}from"./app-Fk2n4M-4.js";const O=[{id:1,text:"15-24",value:"JOVEN"},{id:2,text:"25-44",value:"ADULTO"},{id:3,text:"45-59",value:"ADULTO MAYOR"},{id:4,text:"+60",value:"TERCERA EDAD"}],D=[{id:1,text:"Hombres",value:"M"},{id:2,text:"Mujeres",value:"F"}],I=[{id:1,text:"Solteros",value:"SOLTERO"},{id:2,text:"Casados",value:"CASADO"},{id:3,text:"Divorciados",value:"DIVORCIADO"},{id:4,text:"Viudos",value:"VIUDO"}],L=[{id:1,text:"Generación Alpha",value:"GENERACIÓN ALPHA"},{id:2,text:"Generación Z",value:"GENERACIÓN Z"},{id:3,text:"Millennials",value:"MILLENNIALS"},{id:4,text:"Generación X",value:"GENERACIÓN X"},{id:5,text:"Boomers",value:"BOOMERS"},{id:6,text:"Silenciosa",value:"GENERACIÓN SILENCIOSA"}];function R(u,n){if(u===null||n===null||u==null||n===void 0||u===""||n==="")return!1;const d=u.toString().replace("Ã‘","Ñ").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),c=n.toString().replace("Ã‘","Ñ").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return d===c}function E(u,n){let d=[...u.personas];return n.forEach(c=>{c.filters.length>0&&(d=d.filter(m=>c.filters.some(p=>R(m[c.attr],p.value))))}),d.length}function G(u){return u.filter((d,c,m)=>m.indexOf(d)===c&&d!==null)}function V(u){const{segmento:n,departamentos:d,provincias:c,distritos:m}=u,[p,x]=f.useState([]),[o,v]=f.useState([]),F=f.useMemo(()=>{let t=[...o],a=[];for(let i=0;i<t.length;i++)a.push(E(n,t.slice(0,i+1)));return a},[o]),A=f.useMemo(()=>E(n,o),[o]);f.useEffect(()=>(x([{attr:"edad_grupo",filters:O,text:"Edad"},{attr:"estado_civil",filters:I,text:"Estado Civil"},{attr:"sexo",filters:D,text:"Género"},{attr:"generacion",filters:L,text:"Generación"},{attr:"departamento",filters:d.map(t=>({id:t.id,text:t.name,value:t.name})),text:"Departamento"},{attr:"provincia",filters:[],text:"Provincia",table:!0},{attr:"distrito",filters:[],text:"Distrito",table:!0},{attr:"var1",filters:G(n.personas.map(t=>t.var1)).map(t=>({id:t,text:t,value:t})),text:"Variable 1",table:!0},{attr:"var2",filters:G(n.personas.map(t=>t.var2)).map(t=>({id:t,text:t,value:t})),text:"Variable 2",table:!0},{attr:"var3",filters:G(n.personas.map(t=>t.var3)).map(t=>({id:t,text:t,value:t})),text:"Variable 3",table:!0}]),()=>{}),[]),f.useEffect(()=>(v(n.filtros),()=>{}),[n]),f.useEffect(()=>{const t=o.find(a=>a.attr==="departamento");if(t){const a=t.filters.map(e=>e.id),i=c.filter(e=>a.includes(e.department_id)).map(e=>({id:e.id,text:e.name,value:e.name}));p.find(e=>e.attr==="provincia")&&x(e=>e.map(l=>l.attr==="provincia"?{...l,filters:i}:l));const r=o.find(e=>e.attr==="provincia");v(r?e=>e.map(l=>l.attr==="provincia"?{...l,filters:i}:l):e=>[...e,{attr:"provincia",text:"Provincia",filters:i}])}else p.find(i=>i.attr==="provincia")&&x(i=>i.map(s=>s.attr==="provincia"?{...s,filters:[]}:s));return()=>{}},[o.find(t=>t.attr==="departamento")]),f.useEffect(()=>{const t=o.find(a=>a.attr==="provincia");if(t){const a=t.filters.map(r=>r.id),i=m.filter(r=>a.includes(r.province_id)).map(r=>({id:r.id,text:r.name,value:r.name}));p.find(r=>r.attr==="distrito")&&x(r=>r.map(e=>e.attr==="distrito"?{...e,filters:i}:e))}else p.find(i=>i.attr==="distrito")&&x(i=>i.map(s=>s.attr==="distrito"?{...s,filters:[]}:s));return()=>{}},[o.find(t=>t.attr==="provincia")]);function C(){v([])}function S(t,a){return o.some(i=>i.attr===t.attr&&i.filters.some(s=>s.id===a.id))}function N(t,a){const i=o.find(s=>s.attr===t.attr);if(i){const s=i.filters.find(e=>e.id===a.id),r={...i};s?r.filters=r.filters.filter(e=>e.id!==a.id):r.filters=[...r.filters,{...a}],r.filters.length===0?v(e=>e.filter(l=>l.attr!==t.attr)):v(e=>e.map(l=>l.attr===t.attr?r:l))}else v(s=>[...s,{...t,filters:[a]}])}return{allFilterGroups:p,activeFilterGroups:o,partialCounts:F,totalCount:A,resetFilters:C,isFilterActive:S,toogleFilter:N}}export{V as default};
